# Persistent PR

Opens a github pull request between two branches if it can be opened.

This is useful if you develop against a branch which is deployed to a staging environment and your production environment is deployed from another branch.

## Options

Pass these in through the environment:

```
GITHUB_TOKEN=xxxx REPO_OWNER=shackpank (....) node index.js
```

- **GITHUB_TOKEN** - Github personal access token. Needs to be generated by someone with permissions to create pull requests on the target project.
- **SOURCE_BRANCH** - The development branch, eg `develop`
- **TARGET_BRANCH** - The release branch, eg `master`
- **REPO_OWNER** - User or organisation owning the repository to target, eg `shackpank`
- **REPO_NAME** - Repository name, eg `persistent-pr`
- **PORT** - Port to listen on (optional; defaults to 4646)

## PR Content

The title is currently `SOURCE BRANCH -> TARGET_BRANCH`.

If you create a `.github/DEPLOYMENT_PULL_REQUEST_TEMPLATE.md` it will be used as the default body text for the opened pull request. Otherwise it will be blank.

## Deployment

This is easiest to deploy with [Heroku](https://heroku.com). You'll need to

- Create an application
- Set the options above (except PORT) as config vars
- Push this repository to it
- Set up a hook in github for `push` events, targeting the URL `https://(your-app-name).herokuapp.com/hook`
